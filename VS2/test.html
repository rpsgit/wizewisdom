<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Online Food Ordering</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background:#f4f4f4;
}
.container {
  max-width:1200px;
  margin:auto;
  padding:15px;
}
h1,h3 { margin:10px 0; }

/* MOBILE-FIRST MENU */
.menu {
  display:grid;
  grid-template-columns:1fr;
  gap:12px;
}
.menu-card {
  background:#fff;
  border-radius:12px;
  padding:15px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.price { font-weight:bold; }
.menu-card button {
  width:100%;
  padding:10px;
  background:#28a745;
  color:white;
  border:none;
  border-radius:8px;
  font-size:16px;
}

/* CART BAR */
.cart-bar {
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#222;
  color:#fff;
  padding:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.cart-bar button {
  background:#ff9800;
  border:none;
  padding:8px 14px;
  border-radius:8px;
}

/* CART PANEL */
.cart-panel {
  display:none;
  background:#fff;
  margin-top:15px;
  padding:15px;
  border-radius:12px;
}
.cart-item {
  border-bottom:1px solid #eee;
  padding:10px 0;
}
textarea { width:100%; }

/* DESKTOP */
@media (min-width:768px){
  .menu { display:none; }
  .desktop { display:block; }
  table {
    width:100%;
    border-collapse:collapse;
    background:#fff;
  }
  th,td {
    border:1px solid #ddd;
    padding:10px;
  }
  .cart-bar {
    position:static;
    background:none;
    color:#000;
    justify-content:flex-end;
  }
}

/* MODAL */
.modal {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
}
.modal-content {
  background:#fff;
  max-width:400px;
  margin:20% auto;
  padding:20px;
  border-radius:12px;
}
.modal-content input {
  width:100%;
  padding:8px;
  margin-bottom:10px;
}
</style>
</head>

<body>

<div class="container">
<h1>Food Ordering</h1>

<div class="menu" id="menuCards"></div>

<div class="desktop" style="display:none;">
<table>
<thead>
<tr><th>Item</th><th>Description</th><th>Price</th><th></th></tr>
</thead>
<tbody id="menuTable"></tbody>
</table>
</div>

<div class="cart-panel" id="cartPanel">
<h3>ðŸ›’ Cart</h3>
<div id="cartItems"></div>
<h3 style="text-align:right;">Total: â‚±<span id="total">0</span></h3>
<button onclick="openCheckout()">Checkout</button>
</div>
</div>

<div class="cart-bar">
<div>Items: <span id="cartCount">0</span></div>
<button onclick="toggleCart()">View Cart</button>
</div>

<div class="modal" id="checkoutModal">
<div class="modal-content">
<h3>Checkout</h3>
<input id="custName" placeholder="Name">
<input id="custPhone" placeholder="Phone">
<input id="custAddress" placeholder="Address">
<button onclick="submitOrder()">Place Order</button>
<button onclick="closeCheckout()">Cancel</button>
</div>
</div>

<script>
/* ======================
   APPS SCRIPT CONNECTION
====================== */
const apiURL = "https://script.google.com/macros/s/AKfycbwh3zjK3wwa_c-FJDKbr5JQ7TVxciGuJ-Xl9r1kjP6dt2LZBUQegTHbjDCCLPsARMAO/exec";

/* SAMPLE MENU */
const menu = [
  {id:1,name:"Chicken Adobo",desc:"Classic Filipino",price:120},
  {id:2,name:"Pork Sisig",desc:"Sizzling pork",price:150},
  {id:3,name:"Beef Kare-Kare",desc:"Peanut stew",price:180}
];

let cart = [];

/* RENDER MENU */
menu.forEach(item=>{
  menuCards.innerHTML += `
    <div class="menu-card">
      <h3>${item.name}</h3>
      <p>${item.desc}</p>
      <div class="price">â‚±${item.price}</div>
      <button onclick='addToCart(${JSON.stringify(item)})'>Add</button>
    </div>`;
  menuTable.innerHTML += `
    <tr>
      <td>${item.name}</td>
      <td>${item.desc}</td>
      <td>â‚±${item.price}</td>
      <td><button onclick='addToCart(${JSON.stringify(item)})'>Add</button></td>
    </tr>`;
});

/* CART */
function addToCart(item){
  const f = cart.find(i=>i.id===item.id);
  f ? f.qty++ : cart.push({...item,qty:1,notes:""});
  renderCart();
}

function renderCart(){
  cartItems.innerHTML="";
  let total=0,count=0;
  cart.forEach(i=>{
    total+=i.qty*i.price;
    count+=i.qty;
    cartItems.innerHTML+=`
      <div class="cart-item">
        <b>${i.name}</b><br>
        <button onclick="changeQty(${i.id},-1)">-</button>
        ${i.qty}
        <button onclick="changeQty(${i.id},1)">+</button>
        â‚±${i.qty*i.price}
        <textarea placeholder="Notes" oninput="i.notes=this.value"></textarea>
      </div>`;
  });
  totalSpan.textContent=total;
  cartCount.textContent=count;
}

function changeQty(id,delta){
  const i = cart.find(x=>x.id===id);
  i.qty+=delta;
  if(i.qty<=0) cart=cart.filter(x=>x.id!==id);
  renderCart();
}

function toggleCart(){
  cartPanel.style.display = cartPanel.style.display==="block"?"none":"block";
}

/* CHECKOUT */
function openCheckout(){
  if(!cart.length) return alert("Cart empty");
  checkoutModal.style.display="block";
}
function closeCheckout(){
  checkoutModal.style.display="none";
}

/* ======================
   SEND TO APPS SCRIPT
====================== */
function submitOrder(){
  const order = {
    customer:{
      name:custName.value,
      phone:custPhone.value,
      address:custAddress.value
    },
    cart,
    total: totalSpan.textContent,
    timestamp: new Date().toISOString()
  };

  fetch(apiURL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(order)
  })
  .then(r=>r.json())
  .then(res=>{
    alert("Order sent successfully!");
    cart=[];
    renderCart();
    closeCheckout();
  })
  .catch(err=>{
    alert("Failed to send order");
    console.error(err);
  });
}
</script>

</body>
</html>
