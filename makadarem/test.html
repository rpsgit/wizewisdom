---
layout: default
title: MAKADAREM FOOD CO.
---

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">

<style>
:root {
  --premium-dark: #1a1a1a;
  --premium-gold: #c5a059;
  --premium-light: #fdfdfd; 
  --text-muted: #666;
  --bg-soft: #f4f4f4;
  --messenger: #0084FF;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { 
  margin: 0; 
  font-family: 'Montserrat', sans-serif; 
  background: var(--bg-soft); 
  color: var(--premium-dark); 
  scroll-behavior: smooth;
}

h1, h2, h3, .price, .tab-btn, #logoFallback, .order-id-display {
  font-family: 'Playfair Display', serif;
}

#closedBanner { 
  display: none; background: var(--premium-dark); color: #fff; 
  padding: 12px; text-align: center; position: sticky; top: 0; z-index: 1001; font-size: 0.85rem; letter-spacing: 1px;
}

.page { 
  max-width: 1100px; margin: 20px auto 150px; padding: 30px; 
  background: var(--premium-light); border-radius: 12px; 
  box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
}

.header-actions { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }

.track-btn, .share-btn {
  background: #fff; border: 1px solid #ddd; padding: 10px 20px; 
  border-radius: 4px; cursor: pointer; font-size: 0.75rem; 
  text-transform: uppercase; letter-spacing: 1px; font-weight: 600;
}
.share-btn { background: var(--premium-dark); color: white; border: none; }

#logo { display: block; margin: 0 auto 15px; max-width: 240px; width: 100%; height: auto; }

.tabs { 
  display: flex; gap: 15px; overflow-x: auto; 
  margin-bottom: 35px; padding-bottom: 10px; border-bottom: 1px solid #eee;
  scrollbar-width: none;
}
.tab-btn {
  background: none; border: none; padding: 10px 15px; cursor: pointer;
  font-size: 1rem; color: var(--text-muted); white-space: nowrap;
}
.tab-btn.active { color: var(--premium-dark); border-bottom: 2px solid var(--premium-gold); font-weight: 600; }

.grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
.item { background: #fff; border-radius: 8px; overflow: hidden; border: 1px solid #f0f0f0; }
.item img { width: 100%; height: 220px; object-fit: cover; cursor: pointer; display: block; }

.body { padding: 18px; }
.item-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.item-info strong { font-size: 1rem; font-weight: 600; line-height: 1.2; }
.price { color: var(--premium-gold); font-size: 1.1rem; }

.actions { display: flex; justify-content: flex-end; align-items: center; gap: 10px; }
.item-check { width: 22px; height: 22px; accent-color: var(--premium-dark); cursor: pointer; }
.item-qty { width: 55px; padding: 6px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }

.total-display { font-size: 2.2rem; margin: 30px 0; text-align: right; color: var(--premium-dark); }

input, textarea {
  width: 100%; padding: 14px; margin-bottom: 12px; border: 1px solid #e0e0e0;
  border-radius: 4px; font-family: 'Montserrat', sans-serif; font-size: 0.9rem;
  outline: none;
}

form.submitted input:invalid, 
form.submitted textarea:invalid { 
  border: 2px solid #ff4d4d !important; 
}

.pay-box { background: #fafafa; padding: 25px; border-radius: 8px; margin: 20px 0; border: 1px solid #eee; }
.pay-option { 
  display: flex; align-items: center; justify-content: flex-start;
  padding: 14px; border: 1px solid #ddd; border-radius: 6px; 
  margin-bottom: 10px; cursor: pointer; background: white; width: 100%;
}
.pay-option span { margin-left: 12px; font-weight: 400; font-size: 0.95rem; }
.pay-option input { margin: 0; width: 18px; height: 18px; }

button.main {
  width: 100%; padding: 20px; background: var(--premium-dark); color: white;
  border: none; border-radius: 4px; cursor: pointer; font-family: 'Montserrat', sans-serif;
  font-weight: 600; letter-spacing: 2px; text-transform: uppercase;
}
button.main:hover { background: var(--premium-gold); }

#cart {
  position: fixed; bottom: 30px; right: 30px;
  background: var(--premium-dark); color: white; padding: 16px 32px;
  border-radius: 50px; cursor: pointer; z-index: 1000; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
  font-weight: 600; font-size: 0.9rem;
}

#floatingMessenger {
  position: fixed; bottom: 100px; right: 30px;
  background: var(--messenger); color: white; width: 56px; height: 56px;
  border-radius: 50%; display: none; justify-content: center; align-items: center;
  box-shadow: 0 8px 20px rgba(0,132,255,0.3); z-index: 1001;
}

#modal, #statusModal, #imageModal {
  display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85);
  backdrop-filter: blur(4px); justify-content: center; align-items: center; z-index: 2000;
}
.modal-box { background: #fff; padding: 40px; border-radius: 8px; max-width: 500px; width: 92%; text-align: center; }
.summary-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #eee; font-size: 0.9rem; }

@media print {
  body * { visibility: hidden; }
  #modalContent, #modalContent * { visibility: visible; }
  #modalContent { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; }
  .track-btn, .main { display: none !important; }
}
</style>

<div id="closedBanner">OUR KITCHEN IS CURRENTLY CLOSED</div>

<div class="page">
  <div class="header-actions">
    <button type="button" class="track-btn" onclick="openStatusModal()">Track Order</button>
    <button type="button" class="share-btn" onclick="shareSite()">Share Menu</button>
  </div>
  
  <img id="logo" src="/assets/images/mfc/Makadarem Food Co.png" onerror="this.style.display='none';document.getElementById('logoFallback').style.display='block'">
  <div id="logoFallback" style="display:none; text-align:center; font-size:1.8rem; margin-bottom: 25px;">MAKADAREM FOOD CO.</div>

  <div class="tabs" id="tabs"></div>

  <form id="form" novalidate>
    <div id="menu"></div>
    <div class="total-display" id="totalDisplay">₱0</div>
    
    <h3 style="margin-bottom: 20px;">Delivery Address</h3>
    <input name="name" id="userName" placeholder="Recipient Name *" required>
    <input type="email" name="email" id="userEmail" placeholder="Email Address (Optional)">
    
    <input name="contact" id="userContact" placeholder="Mobile Number (e.g. 09171234567) *" 
           required type="tel" pattern="^(09|\+639)\d{9}$" title="Please enter a valid PH mobile number">
    
    <input name="address" id="userAddress" placeholder="Full Delivery Address *" required>
    <textarea name="notes" id="userNotes" rows="2" placeholder="Nearby landmarks or instructions (Optional)"></textarea>
    
    <h3 style="margin-top: 30px; margin-bottom: 20px;">Payment Method</h3>
    <div class="pay-box">
      <label class="pay-option">
        <input type="radio" name="payment" value="Cash" checked onclick="togglePay()">
        <span>Cash on Delivery</span>
      </label>
      <div id="cashLogic" style="margin-left: 45px; margin-bottom: 15px;">
        <input type="text" id="changeFor" placeholder="Change for how much? (Optional)">
      </div>

      <label class="pay-option">
        <input type="radio" name="payment" value="GCash" onclick="togglePay()">
        <span>GCash Transfer</span>
      </label>

      <label class="pay-option">
        <input type="radio" name="payment" value="Maya" onclick="togglePay()">
        <span>Maya Transfer</span>
      </label>
      
      <div id="payInstructions" style="display:none; margin-top: 15px; padding: 20px; background: #fff; border: 1px dashed #ccc;">
        <p style="font-size: 0.8rem; margin-bottom: 10px;">Send to <span id="payLabel" style="font-weight:600;"></span>:</p>
        <div style="font-size: 1.3rem; font-weight: 700; color: var(--premium-gold); margin-bottom: 10px;" id="payNum"></div>
        <button type="button" onclick="copyText('payNum')" class="track-btn" style="font-size:0.65rem;">Copy Number</button>
      </div>
    </div>

    <button type="submit" class="main">Place My Order</button>
  </form>
</div>

<div id="cart" onclick="showSummary()">
  BAG (<span id="cartCount">0</span>) • ₱<span id="cartSum">0</span>
</div>

<a id="floatingMessenger" href="#" target="_blank">
  <svg width="28" height="28" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.477 2 2 6.145 2 11.258c0 2.91 1.453 5.527 3.734 7.28l-.01 2.266 2.11-1.154c.734.204 1.516.314 2.32.314 5.523 0 10-4.145 10-9.258S17.523 2 12 2zm1.074 12.553l-2.583-2.753-5.043 2.753 5.543-5.889 2.66 2.753 4.965-2.753-5.542 5.889z"/></svg>
</a>

<div id="modal">
  <div class="modal-box" id="modalContent">
    <h2 style="margin-bottom: 25px;">Review Order</h2>
    <div id="preview" style="margin-bottom: 30px;"></div>
    <button class="main" id="finalBtn" onclick="confirmOrder()">Confirm Order</button>
    <button type="button" onclick="document.getElementById('modal').style.display='none'" style="margin-top:15px; background:none; border:none; color: #999; cursor:pointer;">Go Back</button>
  </div>
</div>

<div id="imageModal" onclick="this.style.display='none'">
  <img id="enlargedImg" src="" style="max-width: 92%; max-height: 85vh; border-radius: 8px;">
</div>

<div id="statusModal">
  <div class="modal-box">
    <h3>Track Your Order</h3>
    <input type="text" id="statusIdInput" placeholder="Enter Reference ID">
    <button class="main" onclick="checkStatus()">Search</button>
    <div id="statusResult" style="margin-top: 25px;"></div>
    <button onclick="document.getElementById('statusModal').style.display='none'" style="margin-top:20px; border:none; background:none; cursor:pointer; color:#888;">Close</button>
  </div>
</div>

<script>
// --- CORE CONFIGURATION ---
// FIXED: Added missing opening quote
const BASE = "https://script.google.com/macros/s/AKfycbydkF2PgXPFe0cQkKzC_F6XWV0_MVrEhiLEPwIX4BTvCDF9DhWgnAXhccUEJQyzTQbh/exec";
let settings = {}, prices = {}, pending = null;

// AUTO-TRACKING LOGIC
window.onload = () => {
  const urlParams = new URLSearchParams(window.location.search);
  const trackId = urlParams.get('track');
  if (trackId) {
    document.getElementById('statusIdInput').value = trackId;
    openStatusModal();
    checkStatus(trackId);
  }
};

// FETCH INITIAL SETTINGS
fetch(BASE + "?func=getSettings").then(r=>r.json()).then(s=>{
  settings = s;
  if (s.closed_today) {
    document.getElementById('closedBanner').style.display="block";
    document.getElementById('form').style.opacity="0.3";
    document.getElementById('form').style.pointerEvents="none";
  }
  if(s.messenger_link) {
    const el = document.getElementById('floatingMessenger');
    el.href = s.messenger_link;
    el.style.display = "flex";
  }
});

// LOAD MENU ITEMS
function loadMenu(){
  fetch(BASE + "?func=getMenu").then(r=>r.json()).then(data=>{
    const tabs = document.getElementById('tabs'), menu = document.getElementById('menu');
    const cats = {};
    
    data.forEach(i => {
      const c = i.Category || "Menu";
      if(!cats[c]) cats[c] = [];
      cats[c].push(i);
    });
    
    Object.keys(cats).forEach((cat, idx) => {
      const id = "cat_" + idx;
      tabs.insertAdjacentHTML('beforeend', `<button type="button" class="tab-btn ${idx===0?'active':''}" onclick="openTab('${id}', this)">${cat}</button>`);
      menu.insertAdjacentHTML('beforeend', `
        <div id="${id}" class="tab-content" style="display:${idx===0?'block':'none'}">
          <div class="grid">${cats[cat].map(i => {
            const key = i.Item.toLowerCase().replace(/\s+/g, "_");
            prices[key] = i.Price;
            const isSoldOut = String(i.SoldOut) === 'true';
            return `
              <div class="item" style="${isSoldOut ? 'opacity:0.6;' : ''}">
                <img src="${i.Image || i.ImageURL || 'https://via.placeholder.com/300'}" loading="lazy" onclick="zoomImg(this.src)">
                <div class="body">
                  <div class="item-info">
                    <strong>${i.Item}</strong>
                    <div class="price">₱${i.Price}</div>
                  </div>
                  <div class="actions">
                    ${isSoldOut ? '<span style="color:red; font-size:0.7rem; font-weight:600;">SOLD OUT</span>' : `
                      <input type="number" name="q_${key}" value="1" min="1" class="item-qty" style="display:none" oninput="updateUI()">
                      <input type="checkbox" name="i_${key}" class="item-check" onchange="updateUI()">
                    `}
                  </div>
                </div>
              </div>`;
          }).join('')}</div>
        </div>`);
    });
  });
}

function openTab(id, btn) {
  document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).style.display = 'block';
  btn.classList.add('active');
}

function updateUI() {
  let total = 0, count = 0;
  const items = [];
  document.querySelectorAll('.item-check').forEach(cb => {
    const key = cb.name.replace("i_", "");
    const qtyInput = document.querySelector(`input[name="q_${key}"]`);
    if(cb.checked) {
      qtyInput.style.display = "block";
      const q = parseInt(qtyInput.value) || 1;
      total += prices[key] * q;
      count += q;
      items.push({ 
        name: key.split('_').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' '), 
        qty: q, 
        sub: prices[key]*q 
      });
    } else { qtyInput.style.display = "none"; }
  });
  document.getElementById('totalDisplay').innerText = "₱" + total;
  document.getElementById('cartSum').innerText = total;
  document.getElementById('cartCount').innerText = count;
  return { total, items };
}

function togglePay() {
  const method = document.querySelector('input[name="payment"]:checked').value;
  const inst = document.getElementById('payInstructions'), cash = document.getElementById('cashLogic');
  if(method === "Cash") {
    inst.style.display = "none"; 
    cash.style.display = "block";
  } else {
    cash.style.display = "none"; 
    inst.style.display = "block";
    document.getElementById('payLabel').innerText = method;
    const num = method === "GCash" ? settings.gcash_number : settings.maya_number;
    document.getElementById('payNum').innerText = num || "No account found";
  }
}

function copyText(id) {
    const text = document.getElementById(id).innerText;
    navigator.clipboard.writeText(text).then(() => alert("Copied: " + text));
}

function zoomImg(src) {
  document.getElementById('enlargedImg').src = src;
  document.getElementById('imageModal').style.display = "flex";
}

function shareSite() {
  const shareData = { title: 'Makadarem Food Co.', text: 'Check out our menu!', url: window.location.href };
  if (navigator.share) { navigator.share(shareData); } 
  else { navigator.clipboard.writeText(window.location.href); alert("Link copied!"); }
}

function showSummary() {
  const form = document.getElementById('form');
  
  // FIXED: Check validity BEFORE showing the modal
  if (!form.checkValidity()) {
    form.classList.add('submitted');
    form.reportValidity();
    return;
  }

  const cart = updateUI();
  if(cart.total === 0) return alert("Your bag is empty.");
  
  let html = '';
  cart.items.forEach(i => { html += `<div class="summary-item"><span>${i.name} × ${i.qty}</span><span>₱${i.sub}</span></div>`; });
  const method = document.querySelector('input[name="payment"]:checked').value;
  html += `<div class="summary-item" style="font-weight:700; color:var(--premium-gold); border-top: 1px solid #eee; margin-top:10px;"><span>Total</span><span>₱${cart.total}</span></div>`;
  document.getElementById('preview').innerHTML = html;
  
  pending = { 
    ...cart, 
    payment: method,
    name: document.getElementById('userName').value,
    email: document.getElementById('userEmail').value || "Not Provided",
    contact: document.getElementById('userContact').value,
    address: document.getElementById('userAddress').value,
    notes: document.getElementById('userNotes').value || "None",
    changeFor: document.getElementById('changeFor').value || "Exact Amount"
  };
  
  document.getElementById('modal').style.display = "flex";
}

document.getElementById('form').onsubmit = (e) => { 
  e.preventDefault(); 
  showSummary(); 
};

async function confirmOrder() {
  const btn = document.getElementById('finalBtn');
  btn.disabled = true; btn.innerText = "SENDING...";
  
  const orderID = "MFC-" + Date.now().toString().slice(-6);
  
  const payload = {
    func: "order",
    orderID: orderID,
    name: pending.name,
    email: pending.email,
    contact: pending.contact,
    address: pending.address,
    items: pending.items.map(i => `${i.name} x${i.qty}`).join(", "),
    total: pending.total,
    payment: pending.payment,
    notes: pending.notes + (pending.payment === "Cash" ? " | Change for: " + pending.changeFor : "")
  };

  try {
    // FIXED: Removed no-cors so we can actually see the response from Google
    await fetch(BASE, { 
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams(payload).toString()
    });
    
    // Success View
    document.getElementById('modalContent').innerHTML = `
      <h2 style="color:var(--premium-gold);">Order Received</h2>
      <p style="font-size:0.9rem;">Reference ID:</p>
      <div style="margin: 20px 0;">
        <span class="order-id-display" id="finalID" style="font-size:1.8rem;">${orderID}</span>
        <div style="margin-top:10px;">
           <button onclick="copyText('finalID')" class="track-btn" style="font-size:0.65rem;">Copy ID</button>
        </div>
      </div>
      <p style="font-size:0.8rem; color:#666; margin-bottom:20px;">Please save this ID to track your order.</p>
      <button class="main" onclick="location.reload()">Return Home</button>
    `;
  } catch (err) {
    // If there is a CORS issue but the order went through, we show this alert.
    alert("Order connection issue. Please check your email or contact us if you don't receive a confirmation.");
    btn.disabled = false; btn.innerText = "Confirm Order";
  }
}

function openStatusModal() { 
  document.getElementById('statusModal').style.display = "flex"; 
  document.getElementById('statusResult').innerHTML = "";
}

async function checkStatus(id) {
  const searchId = id || document.getElementById('statusIdInput').value;
  if(!searchId) return;
  const res = document.getElementById('statusResult');
  res.innerText = "Searching database...";
  
  try {
    const r = await fetch(BASE + "?func=checkStatus&id=" + searchId);
    const d = await r.json();
    if(d.found) {
      res.innerHTML = `
        <div style="background:#f9f9f9; padding:15px; border:1px solid #eee; border-radius:8px;">
          <p style="margin:0; font-size:0.8rem; color:#666;">Current Status for ${searchId}:</p>
          <strong style="color:var(--premium-gold); font-size:1.4rem;">${d.status}</strong>
        </div>`;
    } else {
      res.innerHTML = `<p style="color:red;">ID not found. Please verify your Reference ID.</p>`;
    }
  } catch(e) { 
    res.innerText = "Network error. Please try again later."; 
  }
}

// Initial Load
loadMenu();
</script>
