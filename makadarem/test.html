---
layout: default
title: Makadarem Menu
---

<style>
html, body { scroll-behavior: auto !important; }
body {
  background: #f5f5f5 url('{{ "/assets/images/menu/bg.png" | relative_url }}') no-repeat center center fixed;
  background-size: cover;
  font-family: "Poppins", Arial, sans-serif;
  margin: 0;
}

/* ===== MAIN CONTAINER ===== */
.page-container {
  width: 95%;
  max-width: 900px;
  margin: 20px auto;
  padding: 15px;
  background: rgba(255,255,255,0.96);
  border-radius: 20px;
  box-shadow: 0 4px 25px rgba(0,0,0,0.15);
}

h1 { text-align: center; color: #4b2e05; }

/* ===== MENU ===== */
.category-container h2 {
  border-bottom: 2px solid #ff7e5f;
  color: #4b2e05;
}

.menu-item {
  display: flex;
  gap: 12px;
  background: #fff;
  border-radius: 10px;
  padding: 8px;
  margin-bottom: 8px;
}

.menu-item img {
  width: 80px;
  height: 60px;
  object-fit: cover;
  border-radius: 6px;
  cursor: pointer;
}

.details h3 { margin: 0; font-size: 1rem; }
.item-desc { font-size: 0.85rem; color: #666; }

.actions {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.actions input[type="number"] {
  width: 45px;
  display: none;
}

/* ===== FORM ===== */
.order-form-section input,
.order-form-section textarea {
  width: 100%;
  margin-bottom: 8px;
  padding: 6px;
}

.order-button {
  background: linear-gradient(135deg,#ff7e5f,#ff5722);
  color: #fff;
  border: none;
  padding: 10px 22px;
  border-radius: 20px;
  font-size: 1rem;
  cursor: pointer;
}

.total-price {
  font-weight: bold;
  color: #ff5722;
  margin: 10px 0;
}

/* ============================= */
/* ðŸ§¾ ORDER SUMMARY (SCREENSHOT) */
/* ============================= */
.order-summary-wrapper {
  display: none;
  margin: 30px auto;
  max-width: 420px;
}

.order-summary-card {
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 6px 25px rgba(0,0,0,0.18);
  border: 2px dashed #ff7e5f;
  position: relative;
}

.order-summary-card h2 {
  text-align: center;
  margin-top: 0;
  color: #4b2e05;
}

.order-summary-content {
  font-size: 0.95rem;
  line-height: 1.5;
}

.order-summary-footer {
  text-align: center;
  font-size: 0.8rem;
  color: #777;
  margin-top: 15px;
}

.summary-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
}

.summary-buttons button {
  flex: 1;
  margin: 0 5px;
  padding: 8px 10px;
  border-radius: 12px;
  border: none;
  font-size: 0.9rem;
  cursor: pointer;
  color: #fff;
  background: linear-gradient(135deg,#ff7e5f,#ff5722);
}

/* ===== MODALS ===== */
#orderPreviewModal, #imageModal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.modal-box {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
}

#imageModal img {
  max-width: 90%;
  max-height: 90%;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 600px) {
  .menu-item img { width: 60px; height: 50px; }
  .order-summary-wrapper { width: 95%; }
  .summary-buttons { flex-direction: column; }
  .summary-buttons button { margin: 5px 0; }
}
</style>

<div class="page-container">
  <h1>Makadarem for VS2</h1>

  <form id="menuForm">
    <div id="menuContainer">Loading menu...</div>

    <div class="total-price" id="totalPrice">Total: â‚±0</div>

    <div class="order-form-section">
      <input name="name" placeholder="Name" required>
      <input name="contact" placeholder="09XXXXXXXXX" required>
      <input name="unit_no" id="unitNo" placeholder="Unit No." required>
      <textarea name="notes" placeholder="Notes"></textarea>
      <span id="unitError" style="color:red;display:none;">Invalid unit format</span>
    </div>

    <button class="order-button">Place Order</button>
  </form>
</div>

<!-- ðŸ§¾ SCREENSHOT-READY ORDER SUMMARY -->
<div class="order-summary-wrapper" id="orderSummaryCard">
  <div class="order-summary-card">
    <h2>Order Summary</h2>
    <div class="order-summary-content" id="finalOrderSummary"></div>

    <div class="summary-buttons">
      <button id="copyOrderBtn">Copy</button>
      <button id="printOrderBtn">Print / Save</button>
    </div>

    <div class="order-summary-footer">
      Screenshot or share this with confirmation ðŸ“¸
    </div>
  </div>
</div>

<!-- IMAGE ZOOM -->
<div id="imageModal"><img id="modalImg"></div>

<!-- CONFIRM MODAL -->
<div id="orderPreviewModal">
  <div class="modal-box">
    <h3>Confirm Order?</h3>
    <div id="orderSummary"></div>
    <button id="confirmOrderBtn">Confirm</button>
    <button id="cancelOrderBtn">Cancel</button>
  </div>
</div>

<script>
/* === GOOGLE APPS SCRIPT LINKS === */
const menuURL = "https://script.google.com/macros/s/AKfycbykjopHttTCH5TcgR_fkHjxDTFJbgKjZ5Qfs-wnJJdD5Z638xYjaAzSerNfsgtAuf41/exec?func=getMenu";
const orderURL = "https://script.google.com/macros/s/AKfycbykjopHttTCH5TcgR_fkHjxDTFJbgKjZ5Qfs-wnJJdD5Z638xYjaAzSerNfsgtAuf41/exec";

const form = document.getElementById("menuForm");
const menuContainer = document.getElementById("menuContainer");
const totalPriceEl = document.getElementById("totalPrice");
const summaryCard = document.getElementById("orderSummaryCard");
const finalSummary = document.getElementById("finalOrderSummary");

let priceMap = {};
let pendingOrder = null;

function makeKey(text) {
  return text.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"").toLowerCase();
}

/* === LOAD MENU === */
fetch(menuURL)
  .then(res => res.json())
  .then(data => {
    menuContainer.innerHTML = "";
    data.forEach(item => {
      const key = makeKey(item.Item);
      priceMap[key] = Number(item.Price || 0);

      menuContainer.innerHTML += `
        <div class="menu-item">
          <div class="details">
            <h3>${item.Item}</h3>
            <p>â‚±${item.Price}</p>
          </div>
          <div class="actions">
            <input type="checkbox" name="item_${key}">
            <input type="number" name="qty_${key}" value="1" min="1">
          </div>
        </div>
      `;
    });
  });

/* === TOTAL === */
menuContainer.addEventListener("change", () => {
  let total = 0;
  document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
    const k = cb.name.replace("item_","");
    const q = Number(form[`qty_${k}`].value);
    total += (priceMap[k] || 0) * q;
  });
  totalPriceEl.textContent = `Total: â‚±${total}`;
});

/* === SUBMIT === */
form.addEventListener("submit", e => {
  e.preventDefault();

  let items = [];
  let total = 0;

  document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
    const k = cb.name.replace("item_","");
    const q = form[`qty_${k}`].value;
    items.push(`${k.replace(/_/g," ")} Ã— ${q}`);
    total += (priceMap[k] || 0) * q;
  });

  pendingOrder = {
    name: form.name.value,
    contact: form.contact.value,
    unit: form.unit_no.value,
    notes: form.notes.value,
    items,
    total
  };

  document.getElementById("orderSummary").innerHTML =
    items.join("<br>") + `<br><br><strong>Total:</strong> â‚±${total}`;

  document.getElementById("orderPreviewModal").style.display = "flex";
});

/* === CANCEL === */
document.getElementById("cancelOrderBtn").onclick = () => {
  document.getElementById("orderPreviewModal").style.display = "none";
};

/* === CONFIRM === */
document.getElementById("confirmOrderBtn").onclick = () => {
  const fd = new FormData(form);
  fd.append("items", pendingOrder.items.join(", "));
  fd.append("total", pendingOrder.total);

  fetch(orderURL, { method: "POST", body: fd })
    .then(() => {
      document.getElementById("orderPreviewModal").style.display = "none";
      summaryCard.style.display = "block";

      finalSummary.innerHTML = `
        <strong>Items:</strong><br>${pendingOrder.items.join("<br>")}<br><br>
        <strong>Total:</strong> â‚±${pendingOrder.total}<br>
        <strong>Name:</strong> ${pendingOrder.name}<br>
        <strong>Contact:</strong> ${pendingOrder.contact}<br>
        <strong>Unit:</strong> ${pendingOrder.unit}
      `;

      window.scrollTo({ top: summaryCard.offsetTop - 20, behavior: "smooth" });
    });
};

/* === COPY & PRINT BUTTONS === */
document.getElementById("copyOrderBtn").onclick = () => {
  const range = document.createRange();
  range.selectNode(finalSummary);
  window.getSelection().removeAllRanges();
  window.getSelection().addRange(range);
  try {
    document.execCommand('copy');
    alert("âœ… Order copied to clipboard!");
  } catch {
    alert("âŒ Copy failed.");
  }
  window.getSelection().removeAllRanges();
};

document.getElementById("printOrderBtn").onclick = () => {
  const printWindow = window.open("", "PRINT", "height=600,width=400");
  printWindow.document.write('<html><head><title>Order Summary</title></head><body>');
  printWindow.document.write(finalSummary.outerHTML);
  printWindow.document.write('</body></html>');
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
};
</script>
